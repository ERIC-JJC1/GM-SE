模型已实例化:
TopoAlignGRU(
  (spatial_encoder_pre): Linear(in_features=4, out_features=128, bias=True)
  (spatial_encoder): TAGConvStack(
    (layers): ModuleList(
      (0-1): 2 x TAGConv(128, 128, K=3)
    )
    (dropout): Dropout(p=0.0, inplace=False)
    (act): ReLU(inplace=True)
  )
  (spatial_encoder_post): Linear(in_features=128, out_features=256, bias=True)
  (temporal_encoder_pre): Sequential(
    (0): Linear(in_features=76, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): ReLU(inplace=True)
  )
  (temporal_encoder): GRU(256, 256, num_layers=2, batch_first=True, dropout=0.1)
  (fusion_module): GatedFusion(
    (align_g): Linear(in_features=256, out_features=256, bias=True)
    (align_s): Linear(in_features=256, out_features=256, bias=True)
    (gate_alpha): Sequential(
      (0): Linear(in_features=512, out_features=256, bias=True)
      (1): Sigmoid()
    )
  )
  (decoder_head): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=2, bias=True)
  )
)
Epoch 1/150 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.03it/s, Loss=1.3347e+01, Res=1.2372e+01, Op=9.7274e-01, Temp=7.4970e-09]
Epoch 1/150 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 168.49it/s]
Traceback (most recent call last):
  File "/home/wzseu/JJC_project/wls_33/train/train_tagru_weakly.py", line 332, in <module>
    main()
  File "/home/wzseu/JJC_project/wls_33/train/train_tagru_weakly.py", line 245, in main
    current_lr = optimizer.param_groups[0]['lr']
NameError: name 'optimizer' is not defined
